library(gcookbook)
library(plyr)
library(reshape2)
library(ggplot2)
library(MASS)
library(plyr)
library(grid)
model<-lm(heightIn~ageYear,heightweight)
summary(model)
pred<-predict(model,"ageYear","heightIn")
sp<-ggplot(heightweight,aes(x=ageYear,y=heightIn))+geom_point()+
geom_line(data=pred)
sp+annotate("text",label="r^2=0.42",x=16.5,y=52)
sp+annotate("text",label="r^2==0.42,parse=TRUE,x=16.5,y=52)
sp+annotate("text",label=eqn,parse=TRUE,x=Inf,y=-Inf,hjust=1.1,vjust=-.5)
ggplot(faithful,aes(x=eruptions,y=waiting))+geom_point()+geom_rug()
ggplot(faithful,aes(x=eruptions,y=waiting))+geom_point()+
geom_rug(position="jitter",size=.2)
subset(countries,Year==2009&healthexp>2000)
sp<-ggplot(subset(countries,Year==2009&healthexp>2000),
aes(x=healthexp,y=infmortality))+geom_point()
sp+annotate("text",x=4350,y=5.4,label="Canada")+
annotate("text",x=7400,y=6.8,label="USA")
sp+geom_text(aes(label=Name),size=4)
sp+geom_text(aes(label=Name),size=4,vjust=0)
sp+geom_text(aes(y=infmortality+.1,label=Name),size=4,vjust=0)
sp+geom_text(aes(label=Name),size=4,hjust=0)
sp+geom_text(aes(x=healthexp+100,label=Name),size=4,hjust=0)
cdat<-subset(countries,Year==2009&healthexp>2000)
cdat$Name1<-cdat$Name
idx<-cdat$Name1%in%c("Canada","Ireland","United Kingdom","United States",
"New Zealand","Iceland","Japan","Luxembourg","Netherlands","Switzerland")
idx
cdat$Name1[!idx]<-NA
ggplot(cdat,aes(x=healthexp,y=infmortality))+geom_point()+
geom_text(aes(x=healthexp+100,label=Name1),size=4,hjust=0)+
xlim(2000,10000)
p<-ggplot(cdat,aes(x=healthexp,y=infmortality,size=GDP))+
geom_point(shape=21,colour="black",fill="cornsilk")
p+scale_size_area(max_size=15)
hec<-HairEyeColor[,,"Male"]+HairEyeColour[,,"Female"]
hec<-melt(hec,value.name="count")
ggplot(hec,aes(x=Eye,y=Hair))+
geom_point(aes(size=count),shape=21,colour="black",fill="cornsilk)+
scale_size_area(max_size=20,guide=FALSE)+
geom_text(aes(y=as.numeric(Hair)-sqrt(count)/22,label=count),vjust=1,
colour="grey60",size=4)
c2009<-subset(countries,Year==2009,select=c(Name,GDP,laborrate,healthexp,infmortality))
pairs(c2009[,2:5])
ggplot(faithful,aes(x=waiting))+geom_histogram()
w<-faithful$waiting
ggplot(NULL,aes(x=w))+geom_histogram()
ggplot(faithful,aes(x=waiting))+
geom_histogram(binwidth=5,fill="white",colour="black")
binsize<-diff(range(faithful$waiting))/15
ggplot(faithful,aes(x=waiting))+
geom_histogram(binwidth=binsize,fill="white",colour="black")
h<-ggplot(faithful,aes(x=waiting))
h+geom_histogram(binwidth=8,fill="white",colour="black",origin=31)
h+geom_histogram(binwidth=8,fill="white",colour="black",origin=35)
ggplot(birthwt,aes(x=bwt))+geom_histogram(fill="white",colour="black")+
facet_grid(smoke~.)
birthwt1<-birthwt
birthwt1$smoke<-factor(birthwt1$smoke)
levels(birthwt1$smoke)
birthwt1$smoke<-revalue(birthwt1$smoke,c("0"="no smoke","1"="smoke"))
ggplot(birthwt1,aes(x=bwt))+geom_histogram(fill="white",colour="black")+
facet_grid(smoke~.)
ggplot(birthwt1,aes(x=bwt))+geom_histogram(fill="white",colour="black")+
facet_grid(race~.)
ggplot(birthwt1,aes(x=bwt))+geom_histogram(fill="white",colour="black")+
facet_grid(race~.,scale="free")
ggplot(birthwt1,aes(x=bwt,fill=smoke))+geom_histogram(position="identity",alpha=0.4)
ggplot(birthwt1,aes(x=bwt,fill=smoke))+geom_histogram(position="identity",alpha=0.4)
ggplot(birthwt1,aes(x=bwt,fill=smoke))+geom_histogram(alpha=0.4)
ggplot(faithful,aes(x=waiting))+geom_density()
ggplot(faithful,aes(x=waiting))+geom_line(stat="density")+expand_limits(y=0)
w<-faithful$waiting
ggplot(NULL,aes(x=w))+geom_density()
ggplot(faithful,aes(x=waiting))+geom_line(stat="density",adjust=.25,colour="red")+
geom_line(stat="density")+
geom_line(stat="density",adjust=2,colour="blue")
ggplot(faithful,aes(x=waiting))+
geom_density(fill="blue",alpha=0.2)+xlim(35,105)
ggplot(faithful,aes(x=waiting))+
geom_density(fill="blue",colour=NA,alpha=.2)+
geom_line(stat="density")+xlim(35,105)
ggplot(faithful,aes(x=waiting,y=..density..))+
geom_histogram(fill="cornsilk",colour="grey60",size=.2)+
geom_density()+xlim(35,105)
ggplot(birthwt1,aes(x=bwt,colour=smoke))+geom_density()
ggplot(birthwt1,aes(x=bwt,fill=smoke))+geom_density(alpha=.3)
ggplot(birthwt1,aes(x=bwt))+geom_density()+facet_grid(smoke~.)
ggplot(birthwt1,aes(x=bwt))+geom_density()+facet_grid(smoke~.)
ggplot(birthwt1,aes(x=bwt,y=..density..))+
geom_histogram(binwidth=200,fill="cornsilk",colour="grey60",size=.2)+
geom_density()+facet_grid(smoke~.)
ggplot(faithful,aes(x=waiting))+geom_freqpoly()
ggplot(faithful,aes(x=waiting))+geom_freqpoly(binwidth=4)
binsize<-diff(range(faithful$waiting))/15
ggplot(faithful,aes(x=waiting))+geom_freqpoly(binwidth=binsize)
ggplot(birthwt,aes(x=factor(race),y=bwt))+geom_boxplot()
ggplot(birthwt,aes(x=factor(race),y=bwt))+geom_boxplot(width=.5)
ggplot(birthwt,aes(x=factor(race),y=bwt))+geom_boxplot(outlier.size=1.5,outlier.shape=21)
ggplot(birthwt,aes(x=1,y=bwt))+geom_boxplot()+
scale_x_continuous(breaks=NULL)+theme(axis.title.x=element_blank())
ggplot(birthwt,aes(x=factor(race),y=bwt))+geom_boxplot(notch=TRUE)
ggplot(birthwt,aes(x=factor(race),y=bwt))+geom_boxplot()+
stat_summary(fun.y="mean",geom="point",shape=23,fill="white")
p<-ggplot(heightweight,aes(x=sex,y=heightIn))
p+geom_violin()
p+geom_violin()+geom_boxplot(width=.1,fill="black",outlier.colour=NA)+
stat_summary(fun.y=median,geom="point",fill="white",shape=21,size=2.5)
p+geom_violin(trim=FALSE)
p+geom_violin(scale="count")
p+geom_violin(adjust=2)
p+geom_violin(adjust=.5)
countries2009<-subset(countries,Year==2009&healthexp>2000)
p<-ggplot(countries2009,aes(x=infmortality))
p+geom_dotplot()
p+geom_dotplot(binwidth=.25)+geom_rug()+
scale_y_continuous(breaks=NULL)+
theme(axis.title.y=element_blank())
p+geom_dotplot(method="histodot",binwidth=.25)+geom_rug()+
scale_y_continuous(breaks=NULL)+theme(axis.title.y=element_blank())
p+geom_dotplot(binwidth=.25,stackdir="center")+
scale_y_continuous(breaks=NULL)+theme(axis.title.y=element_blank())
p+geom_dotplot(binwidth=.25,stackdir="centerwhole")+
scale_y_continuous(breaks=NULL)+theme(axis.title.y=element_blank())
ggplot(heightweight,aes(x=sex,y=heightIn))+
geom_dotplot(binaxis="y",binwidth=.5,stackdir="center")
ggplot(heightweight,aes(x=sex,y=heightIn))+
geom_boxplot(outlier.colour=NA,width=.4)+
geom_dotplot(binaxis="y",binwidth=.5,stackdir="center",fill=NA)
ggplot(heightweight,aes(x=sex,y=heightIn))+
geom_boxplot(aes(x=as.numeric(sex)+.2,group=sex),width=.25)+
geom_dotplot(aes(x=as.numeric(sex)-.2,group=sex),binaxis="y",
binwidth=.5,stackdir="center")+
scale_x_continuous(breaks=1:nlevels(heightweight$sex),
labels=levels(heightweight$sex))
p<-ggplot(faithful,aes(x=eruptions,y=waiting))
p+geom_point()+stat_density2d()
p+stat_density2d(aes(colour=..level..))
p+stat_density2d(aes(fill=..density..),geom="raster",contour=FALSE)
p+geom_point()+stat_density2d(aes(alpha=..density..),geom="tile",contour=FALSE)
p+stat_density2d(aes(fill=..density..),geom="raster",contour=FALSE,h=c(.5,5))
p<-ggplot(faithful,aes(x=eruptions,y=waiting))+geom_point()
p+annotate("text",x=3,y=48,label="Group1")+
annotate("text",x=4.5,y=66,label="Group2")
p+annotate("text",x=3,y=48,label="Group1",
family="serif",fontface="italic",colour="darkred",size=3)+
annotate("text",x=4.5,y=66,label="Group2",
family="serif",fontface="italic",colour="darkred",size=3)
p+annotate("text",x=3,y=48,label="Group1",alpha=.1)+
geom_text(x=4.5,y=66,label="Group2",alpha=.1)
p+annotate("text",x=-Inf,y=Inf,label="upper left",hjust=-.2,vjust=2)+
annotate("text",x=mean(range(faithful$eruptions)),y=-Inf,vjust=-.4,label="Bottom middle")
p<-ggplot(data.frame(x=c(-3,3)),aes(x=x))+stat_function(fun=dnorm)
p+annotate("text",x=2,y=0.3,parse=TRUE,label="frac(1,sqrt(2*pi))*e^{-x^2/2}")
p+annotate("text",x=0,y=0.05,parse=TRUE,size=4,label="'function:'*y==frac(1,sqrt(2*pi))*e^{-x^2/2}")
p<-ggplot(heightweight,aes(x=ageYear,y=heightIn,colour=sex))+geom_point()
p+geom_hline(yintercept=60)+geom_vline(xintercept=14)
p+geom_abline(intercept=37.4,slope=1.75)
hw_means<-ddply(heightweight,"sex",summarise,heightIn=mean(heightIn))
p+geom_hline(aes(yintercept=heightIn,colour=sex),data=hw_means,
linetype="dashed",size=1)
pg<-ggplot(PlantGrowth,aes(x=group,y=weight))+geom_point()
pg+geom_vline(xintercept=2)
pg+geom_vline(xintercept=which(levels(PlantGrowth$group)=="ctrl"))
p<-ggplot(subset(climate,Source=="Berkeley"),aes(x=Year,y=Anomaly10y))+geom_line()
p+annotate("segment",x=1950,xend=1980,y=-.25,yend=-.25)
p+annotate("segment",x=1850,xend=1820,y=-.8,yend=-.95,
colour="blue",size=2,arrow=arrow())+
annotate("segment",x=1950,xend=1980,y=-.25,yend=-.25,
arrow=arrow(ends="both",angle=90,length=unit(.2,"cm")))
p+annotate("rect",xmin=1950,xmax=1980,ymin=-1,ymax=1,alpha=.1,fill="blue")
pg<-PlantGrowth
pg$hl<-"no"
pg$hl[pg$group=="trt2"]<-"yes"
ggplot(pg,aes(x=group,y=weight,fill=hl))+geom_boxplot()+
scale_fill_manual(values=c("grey85","#FFDDCC"),guide=FALSE)
ggplot(PlantGrowth,aes(x=group,y=weight,fill=group))+geom_boxplot()+
scale_fill_manual(values=c("grey85","grey85","#FFDDCC"),guide=FALSE)
ce<-subset(cabbage_exp,Cultivar=="c39")
ggplot(ce,aes(x=Date,y=Weight))+
geom_bar(fill="white",colour="black")+
geom_errorbar(aes(ymin=Weight-se,ymax=Weight+se),width=.2)
ggplot(ce,aes(x=Date,y=Weight))+
geom_line(aes(group=1))+geom_point(size=4)+
geom_errorbar(aes(ymin=Weight-se,ymax=Weight+se),width=.2)
